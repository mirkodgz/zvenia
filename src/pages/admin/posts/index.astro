---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import PostsTable from '../../../components/admin/tables/PostsTable';
import { isAdministrator, type UserRole } from '../../../lib/admin/roles';

// Server Side Protection
const user = Astro.locals.user;
const profile = (Astro.locals as any).profile;
const userRole = (profile?.role || (user as any)?.role || 'Basic') as UserRole;

if (!user || !isAdministrator(userRole)) {
    return Astro.redirect('/');
}
---

<AdminLayout title="Posts">
    <PostsTable client:load />
</AdminLayout>

