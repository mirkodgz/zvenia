---
import AdminLayout from '../../layouts/AdminLayout.astro';
import UsersTable from '../../components/admin/tables/UsersTable';

// Server Side Protection
const user = Astro.locals.user;
const profile = Astro.locals.profile;
if (!user || !profile || profile.role !== 'Administrator') {
    return Astro.redirect('/');
}
---

<AdminLayout title="Users" activePage="users">
    <div class="mb-6 flex justify-between items-end">
        <div>
            <h1 class="text-2xl font-bold text-white tracking-tight">User Management</h1>
            <p class="text-gray-400 text-sm mt-1">Manage users, roles, companies and work countries.</p>
        </div>
        <button class="bg-primary-600 hover:bg-primary-500 text-black font-bold py-2 px-4 rounded-lg text-sm transition-colors flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
            Add User
        </button>
    </div>

    <!-- The User Table Component -->
    <UsersTable client:load />

</AdminLayout>
