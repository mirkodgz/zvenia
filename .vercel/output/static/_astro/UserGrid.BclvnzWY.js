import{j as e}from"./jsx-runtime.BBGWwODT.js";import{r as s}from"./index.DYwCuWnG.js";import{c as U}from"./createLucideIcon.t37AtwoZ.js";import{G as T}from"./globe.BwzgleDB.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=U("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=U("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),I=({user:r})=>{const n=r.profile_slug?`/profile/${r.profile_slug}`:`/profile/${r.id}`,p=new Date(r.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o=r.full_name||r.email.split("@")[0],m=o[0].toUpperCase(),f=r.role==="Expert"||r.role==="CountryManager"||r.role==="Administrator";return e.jsx("a",{href:n,className:"block group",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex flex-col items-center text-center transition-all duration-300 hover:shadow-md h-full",style:{border:"1px solid rgba(13, 36, 27, 0.2)"},children:[e.jsx("div",{className:"relative mb-4 group-hover:scale-105 transition-transform duration-300",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 overflow-hidden border-2 border-white shadow-sm",children:r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:o,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200 text-gray-400 text-3xl font-bold",children:m})})}),e.jsx("p",{className:"text-xs text-green-600 font-medium mb-1 line-clamp-1",children:p}),e.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-1 group-hover:text-primary-600 transition-colors",children:[e.jsx("h3",{className:"text-dark font-bold text-lg line-clamp-1",children:o}),f&&e.jsx("div",{title:"Verified User",className:"shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),e.jsx("p",{className:"text-gray-500 text-sm mb-3 h-5",children:r.profession||"N/A"}),e.jsx("div",{className:"mt-auto pt-4 w-12 border-b-2 border-primary-500 opacity-0 group-hover:opacity-100 transition-opacity"})]})})},P=["Expert","CountryManager","Administrator","User"],D=()=>{const[r,n]=s.useState([]),[p,o]=s.useState([]),[m,f]=s.useState(1),[i,j]=s.useState(!1),[y,v]=s.useState(!0),[L,E]=s.useState(0),[h,N]=s.useState(""),[g,w]=s.useState("All"),[x,S]=s.useState("All"),c=s.useRef(null),d=s.useRef(null);s.useEffect(()=>{(async()=>{try{const a=await fetch("/api/countries");if(a.ok){const l=await a.json();o(l)}}catch(a){console.error("Failed to load countries",a)}})()},[]);const C=async(t,a=!1)=>{if(!i){j(!0);try{const l=new URLSearchParams({page:t.toString(),limit:"12",...h&&{search:h},...g!=="All"&&{country:g},...x!=="All"&&{role:x}}),A=await fetch(`/api/users?${l}`);if(!A.ok)throw new Error("Failed to fetch");const u=await A.json();n(a||t===1?u.users:k=>{const _=new Set(k.map(b=>b.id)),M=u.users.filter(b=>!_.has(b.id));return[...k,...M]}),E(u.total),v(u.page<u.totalPages),f(t)}catch(l){console.error(l)}finally{j(!1)}}};return s.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{f(1),n([]),v(!0),C(1,!0)},500),()=>{d.current&&clearTimeout(d.current)}),[h,g,x]),s.useEffect(()=>{const t=new IntersectionObserver(a=>{a[0].isIntersecting&&y&&!i&&r.length>0&&C(m+1)},{threshold:.1});return c.current&&t.observe(c.current),()=>{c.current&&t.unobserve(c.current)}},[y,i,m,r.length]),e.jsxs("div",{children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-8 animate-in fade-in slide-in-from-top-4 duration-500",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"Search by name...",value:h,onChange:t=>N(t.target.value),className:"w-full pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all",style:{paddingLeft:"3rem"}})]}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),e.jsxs("select",{value:x,onChange:t=>S(t.target.value),className:"w-full pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none appearance-none bg-white cursor-pointer",style:{paddingLeft:"3rem"},children:[e.jsx("option",{value:"All",children:"All Roles"}),P.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5 pointer-events-none"}),e.jsxs("select",{value:g,onChange:t=>w(t.target.value),className:"w-full pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none appearance-none bg-white cursor-pointer",style:{paddingLeft:"3rem"},children:[e.jsx("option",{value:"All",children:"All Countries"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]})}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-dark inline-flex items-center gap-2",children:["Total Users: ",e.jsx("span",{className:"text-green-600",children:L})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map(t=>e.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-300",children:e.jsx(I,{user:t})},t.id))}),e.jsxs("div",{ref:c,className:"py-12 text-center w-full",children:[i&&e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),!y&&r.length>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400 text-sm",children:[e.jsx("span",{children:"âœ“"})," All users loaded"]}),!i&&r.length===0&&e.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(R,{className:"w-12 h-12 mb-4 opacity-20"}),e.jsx("p",{className:"text-lg font-medium",children:"No users found matching filters."}),e.jsx("button",{onClick:()=>{N(""),w("All"),S("All")},className:"mt-4 text-green-600 hover:underline text-sm font-semibold",children:"Clear filters"})]})]})]})};export{D as default};
