import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.WFquGv8Z.js";import{c as N}from"./index.DkUcqVkk.js";const v=["Administrator","CountryManager","Ads","Events","Expert","Basic"];function I(){const[c,i]=l.useState([]),[p,n]=l.useState(!0),[d,m]=l.useState(""),[g,x]=l.useState(null),[s,o]=l.useState({role:"Basic",country:""}),h=N("https://ddgdtdhgaqeqnoigmfrh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZ2R0ZGhnYXFlcW5vaWdtZnJoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcwNDE3NjMsImV4cCI6MjA4MjYxNzc2M30.aSW3Ds1z-8ta1sx-22P3NGyx4jzaY0aGNPPB9PsFcs0");l.useEffect(()=>{u()},[]);const u=async()=>{n(!0);const{data:t,error:r}=await h.from("profiles").select("*").order("created_at",{ascending:!1}).limit(100);r?(console.error("Error fetching users:",r),alert("Error fetching users")):i(t||[]),n(!1)},b=async t=>{t.preventDefault(),n(!0);const{data:r,error:a}=await h.from("profiles").select("*").ilike("email",`%${d}%`).order("created_at",{ascending:!1});a?console.error("Error searching users:",a):i(r||[]),n(!1)},j=t=>{x(t.id),o({role:t.role||"Basic",country:t.country||""})},f=()=>{x(null),o({role:"Basic",country:""})},y=async t=>{const{error:r}=await h.from("profiles").update({role:s.role,country:s.country||null}).eq("id",t);r?(console.error("Error updating profile:",r),alert("Failed to update user: "+r.message)):(i(c.map(a=>a.id===t?{...a,role:s.role,country:s.country||null}:a)),x(null))};return e.jsxs("div",{className:"bg-[#1A1A1A] rounded-lg border border-white/10 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"User Management"}),e.jsxs("form",{onSubmit:b,className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search email...",value:d,onChange:t=>m(t.target.value),className:"bg-black/20 border border-white/10 rounded px-3 py-1 text-white text-sm focus:border-primary-500 outline-none"}),e.jsx("button",{type:"submit",className:"bg-white/5 hover:bg-white/10 border border-white/10 text-white px-3 py-1 rounded text-sm transition-colors",children:"Search"}),d&&e.jsx("button",{type:"button",onClick:()=>{m(""),u()},className:"text-gray-400 hover:text-white text-sm",children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-gray-400",children:[e.jsx("thead",{className:"bg-white/5 uppercase font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"User"}),e.jsx("th",{className:"p-3",children:"Email"}),e.jsx("th",{className:"p-3",children:"Role"}),e.jsx("th",{className:"p-3",children:"Country"}),e.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center",children:"Loading users..."})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center",children:"No users found."})}):c.map(t=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"p-3 font-medium text-white flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-neutral-700 flex items-center justify-center text-xs overflow-hidden",children:t.avatar_url?e.jsx("img",{src:t.avatar_url,className:"w-full h-full object-cover"}):t.email?.[0].toUpperCase()}),t.full_name||"N/A"]}),e.jsx("td",{className:"p-3",children:t.email}),g===t.id?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-3",children:e.jsx("select",{value:s.role,onChange:r=>o({...s,role:r.target.value}),className:"bg-black border border-primary-500 rounded px-2 py-1 text-white outline-none w-full",children:v.map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"text",value:s.country,onChange:r=>o({...s,country:r.target.value}),placeholder:"Country...",className:"bg-black border border-primary-500 rounded px-2 py-1 text-white outline-none w-full"})}),e.jsxs("td",{className:"p-3 text-right flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>y(t.id),className:"text-green-400 hover:text-green-300",children:"Save"}),e.jsx("button",{onClick:f,className:"text-gray-500 hover:text-gray-400",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs border ${t.role==="Administrator"?"border-red-500/30 bg-red-500/10 text-red-400":t.role==="CountryManager"?"border-blue-500/30 bg-blue-500/10 text-blue-400":t.role==="Expert"?"border-purple-500/30 bg-purple-500/10 text-purple-400":"border-gray-500/30 bg-gray-500/10 text-gray-400"}`,children:t.role})}),e.jsx("td",{className:"p-3",children:t.country||"-"}),e.jsx("td",{className:"p-3 text-right",children:e.jsx("button",{onClick:()=>j(t),className:"text-primary-400 hover:text-primary-300 font-medium",children:"Edit"})})]})]},t.id))})]})})]})}export{I as default};
