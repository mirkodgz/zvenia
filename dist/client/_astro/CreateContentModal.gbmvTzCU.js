import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.WFquGv8Z.js";import k from"./PostForm.BCDFshWi.js";import N from"./EventForm.B329yV0p.js";import C from"./PodcastForm.CStAsSlk.js";import E from"./ServiceForm.mujw9o6i.js";import"./supabase.E32zLJp1.js";import"./index.DkUcqVkk.js";function W({currentUser:s,userInitials:p,activeFeed:m="post"}){const[l,n]=o.useState(!1),[a,d]=o.useState("post"),[v,c]=o.useState(null),h=o.useRef(null);o.useEffect(()=>{const r=t=>{t.key==="Escape"&&n(!1)};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[]),o.useEffect(()=>{const r=t=>{const{type:j,id:y}=t.detail;c(y),d(j),n(!0)};return window.addEventListener("open-edit-modal",r),()=>window.removeEventListener("open-edit-modal",r)},[]),o.useEffect(()=>{l||c(null)},[l]);const u=r=>{r.target===r.currentTarget&&n(!1)},b=(r="post")=>{c(null),d(r),n(!0)},f=r=>{window.location.href=`/?feed=${r}`},i=s?.role||"Basic",x=[{id:"post",label:"Posts",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})},{id:"event",label:"Events",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),e.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),e.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})},{id:"podcast",label:"Podcasts",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),e.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})},{id:"service",label:"Services",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]})}],w=(()=>{if(i==="Administrator"||i==="CountryManager")return x;const r=["post"];return i==="Events"&&r.push("event"),i==="Expert"&&r.push("podcast"),i==="Ads"&&r.push("service"),x.filter(t=>r.includes(t.id))})(),g=r=>`flex items-center gap-2 py-2 px-3 rounded text-sm font-semibold transition-all duration-200 ${m===r?"bg-primary-500/10 text-primary-400 border border-primary-500/20 shadow-[0_0_15px_rgba(var(--color-primary-500),0.1)]":"text-[var(--text-secondary)] hover:bg-[var(--bg-surface-hover)] hover:text-[var(--text-main)] border border-transparent"}`;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-[var(--bg-surface)] rounded-lg border border-[var(--border-color)] p-4 mb-6",children:[e.jsxs("div",{onClick:()=>b("post"),className:"flex gap-3 group cursor-pointer",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--bg-surface-hover)] flex-shrink-0 flex items-center justify-center border border-[var(--border-color)] group-hover:border-primary-500/50 transition-colors text-[var(--text-main)] font-bold",children:p}),e.jsx("div",{className:"w-full bg-[var(--bg-body)] border border-[var(--border-color)] rounded-full px-6 py-3 text-sm text-[var(--text-secondary)] group-hover:border-primary-500/50 group-hover:text-[var(--text-main)] transition-all flex items-center shadow-inner",children:"Start a post, share a mining update..."})]}),e.jsx("div",{className:"flex justify-between items-center mt-4 pt-3 pl-16",children:e.jsx("div",{className:"flex gap-2 sm:gap-4 overflow-x-auto no-scrollbar",children:x.map(r=>e.jsxs("button",{onClick:()=>f(r.id),className:g(r.id),children:[r.icon," ",r.label]},r.id))})})]}),l&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-in fade-in duration-200",onClick:u,children:e.jsxs("div",{ref:h,className:"bg-[var(--bg-surface)] w-full max-w-4xl max-h-[90vh] rounded-xl border border-[var(--border-color)] shadow-2xl overflow-hidden flex flex-col relative animate-in zoom-in-95 duration-200",children:[e.jsx("button",{onClick:()=>n(!1),className:"absolute top-4 right-4 text-[var(--text-secondary)] hover:text-[var(--text-main)] z-10 p-2 rounded-full hover:bg-[var(--bg-surface-hover)] transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"p-6 border-b border-[var(--border-color)] bg-[var(--bg-surface)]",children:e.jsx("h2",{className:"text-xl font-bold text-[var(--text-main)]",children:v?"Edit Content":"Create Content"})}),e.jsx("div",{className:"border-b border-[var(--border-color)] bg-[var(--bg-surface)] px-6",children:e.jsx("nav",{className:"flex -mb-px space-x-8","aria-label":"Tabs",children:w.map(r=>e.jsxs("button",{onClick:()=>d(r.id),className:`
                                            group inline-flex items-center whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors
                                            ${a===r.id?"border-primary-500 text-primary-400":"border-transparent text-[var(--text-secondary)] hover:text-[var(--text-main)] hover:border-[var(--border-color)]"}
                                        `,children:[e.jsx("span",{className:"mr-2",children:r.icon}),r.label]},r.id))})}),e.jsxs("div",{className:"overflow-y-auto p-6 md:p-8 custom-scrollbar bg-[var(--bg-body)] flex-1",children:[a==="post"&&e.jsx(k,{currentUser:s,initialData:{editId:v||void 0}}),a==="event"&&e.jsx(N,{currentUser:s}),a==="podcast"&&e.jsx(C,{currentUser:s}),a==="service"&&e.jsx(E,{currentUser:s})]})]})})]})}export{W as default};
